INSERT INTO students (name, second_name, group_id)
VALUES ('Kirill', 'Zharoff', NULL);



INSERT INTO `groups` (title, start_date, end_date)
VALUES ('Groupa_Beta_2', '01.01.2000', '01.01.2022')

SELECT id FROM `groups` WHERE title = 'Groupa_Beta_2';


UPDATE students
SET group_id = (SELECT id FROM `groups` WHERE title = 'Groupa_Beta_2')
WHERE name = 'Kirill' AND second_name = 'Zharoff';



INSERT INTO books (title, taken_by_student_id)
VALUES
('Python book', 1393),
('SQL book', 1393);



INSERT INTO subjets (title)
VALUES
('Python cours'),
('SQL cours');





INSERT INTO lessons (title, subject_id)
VALUES
('Lesson 10', 1849),
('Lesson 20', 1850);





INSERT INTO marks (value, lesson_id, student_id)
VALUES
(5, 4220, 1393),
(10, 4221, 1393);



SELECT m.value, l.title AS lesson_title
FROM marks m
JOIN lessons l ON m.lesson_id = l.id
WHERE m.student_id = 1393;


SELECT b.title
FROM books b
WHERE b.taken_by_student_id = 1393;




SELECT
    students.id,
    students.name,
    students.second_name,
    `groups`.title AS group_title,
    `groups`.start_date,
    `groups`.end_date,
    GROUP_CONCAT(DISTINCT books.title) AS books,
    GROUP_CONCAT(DISTINCT subjets.title) AS subjects,
    GROUP_CONCAT(DISTINCT lessons.title) AS lessons,
    GROUP_CONCAT(DISTINCT marks.value) AS marks
FROM
    students
LEFT JOIN `groups` ON students.group_id = `groups`.id
LEFT JOIN books ON students.id = books.taken_by_student_id
LEFT JOIN marks ON students.id = marks.student_id
LEFT JOIN lessons ON marks.lesson_id = lessons.id
LEFT JOIN subjets ON lessons.subject_id = subjets.id
WHERE
    students.id = 1393
GROUP BY
    students.id, students.name, students.second_name, `groups`.title, `groups`.start_date, `groups`.end_date;




